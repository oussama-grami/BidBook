<div class="add-book-container">
  <div class="content-container">
    <h1 class="title">ADD A BOOK</h1>

    <div class="form-and-image">
      <form [formGroup]="addBookForm" (ngSubmit)="onSubmit()">
        <div class="form-grid">
          <div class="form-group">
            <label for="title">Title</label>
            <input
              type="text"
              id="title"
              formControlName="title"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="author">Author</label>
            <input
              type="text"
              id="author"
              formControlName="author"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="category">Category</label>
            <div class="select-container">
              <select
                id="category"
                formControlName="category"
                class="form-control"
              >
                <option value="" disabled selected>Select</option>
                <option value="fiction">Fiction</option>
                <option value="non-fiction">Non-Fiction</option>
                <option value="science">Science</option>
                <option value="history">History</option>
                <option value="biography">Biography</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="numberOfPages">Number of Pages</label>
            <input
              type="number"
              id="numberOfPages"
              formControlName="numberOfPages"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="age">Age</label>
            <div class="select-container">
              <select id="age" formControlName="age" class="form-control">
                <option value="" disabled selected>Select</option>
                <option value="children">Children</option>
                <option value="young-adult">Young Adult</option>
                <option value="adult">Adult</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="edition">Edition</label>
            <input
              type="text"
              id="edition"
              formControlName="edition"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="picture">Picture</label>
            <input
              type="file"
              id="picture"
              (change)="onFileSelected($event)"
              class="form-control file-input"
              accept="image/*"
            />
          </div>

          <div class="preview-container" *ngIf="previewImage || selectedFile">
            <p-image
              [src]="previewImage || '/images/AddBook.png'"
              [alt]="selectedFile?.name || 'Book preview'"
              [preview]="true"
            ></p-image>
          </div>

          <div
            class="price-prediction-container"
            *ngIf="isPredicting || showPriceResult"
          >
            <div class="loading-indicator" *ngIf="isPredicting">
              <div class="spinner"></div>
              <p>Predicting price...</p>
            </div>

            <div
              class="prediction-result"
              *ngIf="showPriceResult && predictedPrice !== null"
            >
              <h3>Predicted Price</h3>
              <p class="predicted-price">{{ predictedPrice }}D</p>
              <div class="prediction-actions">
                <button
                  type="button"
                  class="accept-btn"
                  (click)="onAcceptPrice()"
                >
                  Accept
                </button>
                <button
                  type="button"
                  class="refuse-btn"
                  (click)="onRefusePrice()"
                >
                  Refuse
                </button>
              </div>
            </div>
          </div>

          <div
            class="form-group price-group"
            *ngIf="predictedPrice && !showPriceResult"
          >
            <label>Price</label>
            <input
              type="number"
              formControlName="price"
              class="form-control"
              [readonly]="priceAccepted"
            />
          </div>
        </div>

        <div class="button-group">
          <button
            type="button"
            pButton
            [disabled]="isPredicting || priceAccepted"
            (click)="predictPrice()"
            class="predict-btn"
          >
            {{ isPredicting ? "Predicting..." : "Predict Price" }}
          </button>
          <button
            type="submit"
            pButton
            [disabled]="addBookForm.invalid || !priceAccepted"
            class="submit-btn"
          >
            Submit
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
